\section{Lecture: Week 2}

\subsection{Wielandt's solvability theorem}

\begin{lemma}
	\label{lemma:4Wielandt}
	Let $G$ be a finite group and $H$ and $K$ be subgroups of $G$ 
        of coprime indices. Then $G=HK$ and $(H:H\cap K)=(G:K)$.
\end{lemma}

\begin{proof}
	Let $D=H\cap K$. Since 
	\[
	(G:D)=\frac{|G|}{|H\cap K|}=(G:H)(H:H\cap K),
	\]
	$(G:H)$ divides $(G:D)$. Similarly, $(G:K)$ divides 
	$(G:D)$. Since $(G:H)$ and $(G:K)$ are coprime, $(G:H)(G:K)$
	divides $(G:D)$. In particular, 
	\[
	\frac{|G|}{|H|}\frac{|G|}{|K|}=(G:H)(G:K)\leq (G:D)=\frac{|G|}{|H\cap K|} 
	\]
	and hence $|G|=|HK|$. Since 
 \[
 |G|=|HK|=|H||K|/|H\cap K|,
 \]
 we conclude that 
	$(G:K)=(H:H\cap K)$.
\end{proof}

\begin{definition}
\index{Normal closure}
Let $G$ be a group and $H$ be a subgroup of $G$. The 
\emph{normal closure} $H^G$ of $H$ in $G$ is the subgroup 
$H^G=\langle xHx^{-1}:x\in G\rangle$.
\end{definition}

\begin{exercise}
Let $G$ be a group and $H$ a subgroup of $G$. Prove that $H^G$ is normal in $G$ and that 
$H^G$ is the smallest normal subgroup of $G$ containing $H$. 
\end{exercise}

% \begin{svgraybox}
% 	Es trivial demostrar que $H^G$ is normal in $G$.  Sea $N$ un subgrupo
% 	normal de $G$ tal que $H\subseteq N$. Since $xHx^{-1}\subseteq xNx^{-1}=N$
% 	para todo $x\in G$, $H\subseteq H^G\subseteq N$. 
% \end{svgraybox}

\begin{example}
Let $G=\Alt_4$ and $H=\{\id,(12)(34)\}$. The normal closure of $H$ in $G$
is 
 \[
 H^G=\{\id,(12)(34),(13)(24),(14)(23)\}\simeq C_2\times C_2.
 \]
\end{example}

\begin{theorem}[Wielandt's solvability theorem]
	\label{theorem:Wielandt:solvable}
    \index{Wielandt's!solvability theorem}
	Let $G$ be a finite group and $H$, $K$ and $L$ be 
        subgroups of $G$ with pairwise coprime indices. 
        If $H$, $K$ and $L$ are solvable, then $G$ is 
	solvable.
\end{theorem}

\begin{proof}
    Let $G$ be a minimal counterexample. Then $G\ne\{1\}$. 
% 	pues por ejemplo\footnote{El núcleo de la restricción
% 	$\ker(\pi|_H)=\ker \pi\cap N$ and entonces $\pi(H)\simeq H/N\cap H$.}
% 	\[
% 	(\pi(G):\pi(H))=(G/N:H/N\cap H)=(G:NH)
% 	\]
% 	divide a $(G:N)$. 
    There are two cases to consider. 
    Assume first that $H=\{1\}$. Then 
    $|G|=(G:H)$ is coprime with $(G:K)$ and thus $G=K$ is solvable. 
    Assume now that  
    $H\ne \{1\}$. Let $M$ be a minimal normal subgroup of $H$. By Lemma~\ref{lem:minimal_normal}, 
    $M$ is a $p$-group for some prime number $p$. 
    Without loss of generality, we may assume that $p$ does not divide $(G:K)$ (otherwise, if $p$ divides $(G:K)$, then 
    $p$ does not divide $(G:L)$ and we just need to change $K$ by $L$). 
    There exists $P\in\Syl_p(G)$ such that $P\subseteq K$. Sylow subgroups are conjugate, so there exists 
    $g\in G$ such that $M\subseteq
	gKg^{-1}$. Since $(G:gKg^{-1})=(G:K)$ is coprime with $(G:H)$, Lemma~\ref{lemma:4Wielandt} implies that
    $G=(gKg^{-1})H$. 
	
    We claim that all conjugates of $M$ are in $gKg^{-1}$. 
    If $x\in G$, write $x=uv$ some some $u\in 
	gKg^{-1}$ and $v\in H$. Since $M$ is normal in $H$, 
	\[
	xMx^{-1}=(uv)M(uv)^{-1}=uMu^{-1}\subseteq gKg^{-1}.
	\]
        Let $N=M^G$ be the normal closure of $M$ in $G$. 
	Then $\{1\}\ne N\subseteq gKg^{-1}$ is solvable, as $gKg^{-1}$ is 
	solvable. We claim that $G/N$ is solvable. Let 
         $\pi\colon G\to G/(M^G)$ be the canonical map. Since $H$, $K$ and $L$ are solvable, 
    the subgroups $\pi(H)$, $\pi(K)$ and $\pi(L)$ of $\pi(G)$ are solvable. By the correspondence theorem, $\pi(H)$, $\pi(K)$ and $\pi(L)$ have pairwise coprime indices. Moreover, $\pi(G)$ is solvable, as
    $|\pi(G)|<|G|$.  
        Hence 
        $G$ is solvable. 
\end{proof}

\subsection{Hall's theorem}

\begin{definition}
\index{$p$-complement}
Let $G$ be a finite group of order $p^{\alpha}m$, where $p$ is a prime number such that 
$\gcd(p,m)=1$. A subgroup 
$H$ of $G$ is said to be a \emph{$p$-complement} if $|H|=m$. 
\end{definition}

\begin{example}
Let $G=\Sym_3$. Then $H=\langle (123)\rangle$ is a $2$-complement and 
$K=\langle (12)\rangle$ is a $3$-complement.
\end{example}

\begin{theorem}[Hall]
\label{theorem:Hall:solvable}
 \index{Hall's theorem}
Let $G$ be a finite group that admits a $p$-complement for every prime divisor $p$ of $|G|$. 
Then $G$ is solvable. 
\end{theorem}

\begin{proof}
	Let $|G|=p_1^{\alpha_1}\cdots
	p_k^{\alpha_k}$ with $p_1<\cdots<p_k$ prime numbers. We proceed by induction on $k$. 
	If $k=1$, then the claim holds, as $G$ is a $p$-group. If $k=2$, the result holds by
        Burnside's theorem. Assume now that 
	$k\geq3$. For $j\in\{1,2,3\}$, let $H_j$ be a $p_j$-complement in 
	$G$. Since $|H_j|=|G|/p_j^{\alpha_j}$, the subgroups $H_j$ have pairwise coprime indices.

	We claim that $H_1$ is solvable. Note that $|H_1|=p_2^{\alpha_2}\cdots
	p_k^{\alpha_k}$. Let $p$ be a prime number dividing $|H_1|$ and $Q$ be a 
	$p$-complement in $G$. 
	Since $(G:H_1)$ and $(G:Q)$ are
	coprime, Lemma~\ref{lemma:4Wielandt} implies that  
	\[
	(H_1:H_1\cap Q)=(G:Q). 
	\]
	Then $H_1\cap Q$ is a $p$-complement in $H_1$.  Therefore $H_1$ is
	solvable by the inductive hypothesis. Similarly, both $H_2$ and 
	$H_3$ are solvable.

	Since $H_1$, $H_2$ and $H_3$ are solvable of pairwise coprime indices, 
        the theorem follows from Wielandt's theorem. 
\end{proof}

\subsection{Nilpotent groups}\

\begin{exercise}[The Hall--Witt identity]
	\label{exercise:HallWitt}
	\index{Hall--Witt identity}
	Let $G$ be a group and $x,y,z\in G$. Prove that 
	\begin{equation}
		\label{eq:HallWitt}
	\left(\prescript{y}{}[x,y^{-1},z]\right)\left(\prescript{z}{}[y,z^{-1},x]\right)\left(\prescript{x}{}[z,x^{-1},y]\right)=1.
	\end{equation}
\end{exercise}

\index{Jacobi, G.}
\index{Jacobi identity}
If $G$ is a group and $[G,G]$ is central in $G$,
then the Hall-Witt identity becomes Jacobi's identity.

%\begin{proof}
%	Como la demostración es simplemente un cálculo de rutina, la dejamos como ejercicio.
%	Calculamos 
%	\begin{align*}
%	&\prescript{y}{}[x,y^{-1},z]=yxy^{-1}zyz^{-1}x^{-1}zy^{-1}z^{-1},\\
%	&\prescript{z}{}[y,z^{-1},x]=zyz^{-1}xzx^{-1}y^{-1}xz^{-1}x^{-1},\\
%	&\prescript{x}{}[z,x^{-1},y]=xzx^{-1}yxy^{-1}z^{-1}yx^{-1}y^{-1}.
%	\end{align*}
%\end{proof}
\begin{lemma}[Hall's three subgroups lemma]
	\label{lemma:3subgrupos}
	\index{Lema!de los tres subgrupos}
	Let $X$, $Y$ and $Z$ be subgroups of $G$ 
 such that $[X,Y,Z]=[Y,Z,X]=\{1\}$.
	Then $[Z,X,Y]=\{1\}$.
\end{lemma}

\begin{proof}
%Since $[x,y]\in C_G(z)$ implies 
Since $[X,Y]\subseteq C_G(Z)$, 
it is enough to prove that $[z,x^{-1},y]=1$ for all $x\in X$, $y\in Y$ and $z\in Z$. Since $[y^{-1},z]\in [Y,Z]$, $[x,y^{-1},z]\in [X,Y,Z]=\{1\}$. Thus $\prescript{y}{}[x,y^{-1},z]=1$. Similarly, $\prescript{z}{}[y,z^{-1},x]=1$. Using the Hall--Witt identity, we conclude that $[z,x^{-1},y]=1$.
\end{proof}

\begin{exercise}
\label{xca:3subgroups}
Let $N$ be a normal subgroup of $G$ and 
$X$, $Y$ and $Z$ be subgroups of $G$. If $[X,Y,Z]\subseteq N$ and $[Y,Z,X]\subseteq N$, then 
$[Z,X,Y]\subseteq N$.
\end{exercise}

%\begin{sol}{xca:3subgroups}
%	Sea $\pi\colon G\to G/N$ el morfismo canónico. Como $[X,Y,Z]\subseteq N$, 
%	\begin{align*}
%		\{1\}&=\pi([X,Y,Z])=\pi([ X,[Y,Z]])\\
%		&=[\pi(X),\pi([Y,Z])]=[ \pi(X),[\pi(Y),\pi(Z)]]=[\pi(X),\pi(Y),\pi(Z)]. 
%	\end{align*}
%	Similarmente $[\pi(Y),\pi(Z),\pi(X)]=\{1\}$. Entonces, gracias al lema de los
%	tres subgrupos, $[\pi(Z),\pi(X),\pi(Y)]=\{1\}$, es decir
%	$[Z,X,Y]\subseteq N$.
%\end{sol}

% \begin{svgraybox}
% 	Sean $h\in H$ y $g\in G$. $hKgK=gKhK$ si y sólo si $[h,g]\in K$.
% \end{svgraybox}

\begin{definition}
\index{Lower central series}
Let $G$ be a group. The \emph{lower central series} 
is the sequence $\gamma_k(G)$ of subgroups defined inductively 
as 
\[
\gamma_1(G)=G,\quad
\gamma_{i+1}(G)=[G,\gamma_i(G)]\quad i\geq 1.
\]
\end{definition}

\begin{definition}
\index{Group!nilpotent}
\index{Nilpotency index}
A group $G$ is said to be \emph{nilpotent} if there exists a positive integer $c$ such that 
$\gamma_{c+1}(G)=\{1\}$. The smallest $c$ with $\gamma_{c+1}(G)=\{1\}$ is 
the \emph{nilpotency class} of $G$.
\end{definition}

\begin{exercise}
\label{xca:nilpotent=>solvable}
Prove that every nilpotent group is solvable. 
\end{exercise}

A group is nilpotent of nilpotency class one if and only if it is abelian. 

\begin{example}
The group $\Sym_3$ is solvable, as 
$\Sym_3\supseteq \Alt_3\supseteq\{1\}$ is a composition series 
with abelian factors. However, $\Sym_3$ is not nilpotent, as 
\[
\gamma_1(\Sym_3)=\Alt_3,\quad
\gamma_2(\Sym_3)=[\Alt_3,\Sym_3]=\Alt_3, 
\]
and therefore $\gamma_i(\Sym_3)\ne\{1\}$ for all $i\geq1$. 
\end{example}

\begin{example}
The group $G=\Alt_4$ is not nilpotent, as 
\[
\gamma_1(G)=G,\quad
\gamma_j(G)=\{\id,(12)(34),(13)(24),(14)(23)\}\simeq C_2\times C_2
\]
for all $j\geq2$. We can do this with the computer:
\begin{lstlisting}
gap> IsNilpotent(AlternatingGroup(4));
false
\end{lstlisting}
Let us do the calculation of the lower central series with the computer: 
\begin{lstlisting}
gap> List(LowerCentralSeries(AlternatingGroup(4)),\
StructureDescription);
[ "A4", "C2 x C2" ]
\end{lstlisting}
Here is an alternative:
\begin{lstlisting}
gap> G := AlternatingGroup(4);;
gap> gamma_1 := G;;
gap> gamma_2 := DerivedSubgroup(G);;
gap> gamma_3 := CommutatorSubgroup(gamma_2,G);;
gap> StructureDescription(gamma_1);
"A4"
gap> StructureDescription(gamma_2);
"C2 x C2"
gap> StructureDescription(gamma_3);
"C2 x C2"
\end{lstlisting}
\end{example}

\begin{exercise}
\label{xca:gamma}
Let $G$ be a group. Prove the following statements: 
\begin{enumerate}
\item Each $\gamma_i(G)$ is a characteristic subgroup of $G$. 
\item $\gamma_i(G)\supseteq\gamma_{i+1}(G)$ for all $i\geq1$.
\item If $f\colon G\to H$ is a surjective group homomorphism, then  
$f(\gamma_i(G))=\gamma_i(H)$ for all $i\geq1$.
\end{enumerate}
\end{exercise}

\begin{exercise}
\label{xca:HxK_nilpotente}
Prove that if $H$ and $K$ are nilpotent groups, then 
$H\times K$ is nilpotent. 
\end{exercise}

\begin{exercise}
\label{xca:nilpotente}
Let $G$ be a nilpotent group. Prove the following statements: 
\begin{enumerate}
\item Subgroups of $G$ are nilpotent. 
\item If $f\colon G\to H$ is a surjective homomorphism, then $H$ is nilpotent.  
\end{enumerate}
\end{exercise}

%\begin{sol}{xca:nilpotent}
%	La primera afirmación es cierta pues $\gamma_i(H)\subseteq\gamma_i(G)$ para
%	todo $i\geq1$. La segunda afirmación: si existe $c$ tal que $\gamma_{c+1}(G)=\{1\}$
%	entonces \[
%	\gamma_{c+1}(H)=f(\gamma_{c+1}(G))=f(\{1\})=\{1\}.\qedhere
%	\]
%\end{sol}

\begin{exercise}
   True or false? If $G$ is a nilpotent group and $N$ is normal 
   subgroup of $G$ such that $N$ and $G/N$ are nilpotent, then 
   $G$ is nilpotent. 
\end{exercise}

%\begin{sol}{xca:nilpotent_notexact}
%    The claim is false. Take $G=\Sym_3$
%    and $N=\langle(123)\rangle$. Then both $N\simeq C_3$ and $G/N\simeq C_2$ are nilpotent, but $G$ is not nilpotent. 
%\end{sol}

\begin{proposition}
\label{pro:nilpotent_pgroups}
Finite $p$-groups are nilpotent.
\end{proposition}

\begin{proof}
We proceed by induction on $|G|$. The case $G=\{1\}$ is trivial. 
Assume the result holds for $p$-groups of order $<|G|$. Since 
$G$ is a $p$-group, $Z(G)\ne\{1\}$. By the inductive hypothesis, 
$G/Z(G)$ is nilpotent. There exists $c$ such that 
$\gamma_{c+1}(G/Z(G))=\{1\}$. 
	
Let $\pi\colon G\to G/Z(G)$ be the canonical map.  
By Exercise~\ref{xca:gamma},
\[
\pi(\gamma_{c+1}(G))=\gamma_{c+1}(G/Z(G))=\{1\}. 
\]
Then $\gamma_{c+1}(G)\subseteq \ker\pi=Z(G)$. Hence
$G$ is nilpotent, as 
\[	
\gamma_{c+2}(G)=[G,\gamma_{c+1}(G)]=[G,Z(G)]=\{1\}.\qedhere
\]
\end{proof}

\begin{theorem}
\label{thm:gamma}
If $G$ is a group, then $[\gamma_i(G),\gamma_j(G)]\subseteq
\gamma_{i+j}(G)$ for all $i,j\geq1$.	
\end{theorem}

\begin{proof}
We proceed by induction on $i$. The case $i=1$ is trivial, as
$[G,\gamma_j(G)]=\gamma_{j+1}(G)$ by definition. Assume that
the result holds for some $i\geq1$ and all $j\geq 1$. 
	
First note that 
\begin{equation*}
[G,\gamma_i(G),\gamma_j(G)]\subseteq [G,\gamma_{i+j}(G)]=\gamma_{i+j+1}(G)
\end{equation*}
by the inductive hypothesis. Moreover, by the inductive hypothesis, 
\begin{equation*}
[\gamma_i(G),\gamma_j(G),G]=[\gamma_i(G),G,\gamma_j(G)]=[\gamma_{i}(G),\gamma_{j+1}(G)]\subseteq \gamma_{i+j+1}(G)
\end{equation*}
By using Exercise~\ref{xca:3subgroups} with $X=G$, $Y=\gamma_i(G)$ and $Z=\gamma_j(G)$,
we get that 
\[
[\gamma_j(G),G,\gamma_i(G)]\subseteq \gamma_{i+j+1}(G).
\]
Hence  
\[
[\gamma_{i+1}(G),\gamma_{j}(G)]=[\gamma_{j}(G),\gamma_{i+1}(G)]=[\gamma_j(G),G,\gamma_i(G)]\subseteq \gamma_{i+j+1}(G).\qedhere
\]
\end{proof}

\index{Weigth of a commutator}
We may have to consider commutators with $n$ copies of the group that are not necessarily associated on the right. For example, if $n=3$, we might have something like $[G,G,G]=[G,[G,G]]$ or $[[G,G],G]$. These expressions will be called commutators of \emph{weight} three. 

\begin{corollary}
In a group $G$, every weight $n$ commutator is contained in 
$\gamma_n(G)$.
\end{corollary}

\begin{proof}
We proceed by induction on $n$. The case $n=1$ is trivial. Assume that $n\geq1$ and 
the result holds for all $j\leq n$. An arbitrary commutator of weight $n+1$ 
is of the form $[A,B]$, where $A$ is a commutator of weight $k$,
$B$ is a commutator of weight $l$ and $n+1=k+l$. Since $k\leq n$ and $l\leq n$, 
the inductive hypothesis implies that  $A\subseteq \gamma_k(G)$ and $B\subseteq
\gamma_l(G)$. Hence $[A,B]\subseteq [\gamma_k(G),\gamma_l(G)]\subseteq
\gamma_{k+l}(G)$ by the previous theorem.
\end{proof}

\begin{exercise}
\label{xca:inclusion}
    Let $G$ be a group. Prove that $G^{(k)}\subseteq \gamma_{2^k}(G)$ for all $k\geq1$. 
\end{exercise}

\begin{exercise}
\label{xca:derived_length}
    Let $G$ be a nilpotent group of class $m$. Prove that
    the derived length (i.e. 
    the length of the derived series) of $G$ is $\leq 1+\log_2m$.
\end{exercise}


The following lemma is important. It states that nilpotent groups satisfy 
the \emph{normalizer condition}. 

\begin{lemma}[normalizer condition]
\label{lem:normalizadora}
\index{Normalizer condition}
Let $G$ be a nilpotent group. If $H$ is a proper subgroup of $G$, then 
$H\subsetneq N_G(H)$.
\end{lemma}

\begin{proof}
There exists $c$ such that $G=\gamma_1(G)\supseteq\cdots\supseteq\gamma_{c+1}(G)=\{1\}$. Since 
$\{1\}=\gamma_{c+1}(G)\subseteq H$ and $\gamma_1(G)\not\subseteq H$, 
let $k$ be the smallest positive integer such that  $\gamma_k(G)\subseteq H$. 
Since
\[
[H,\gamma_{k-1}(G)]\subseteq [G,\gamma_{k-1}(G)]=\gamma_k(G)\subseteq H,
\]
we obtain that  
$xHx^{-1}\subseteq H$ for all $x\in\gamma_{k-1}(G)$,
that is $\gamma_{k-1}(G)\subseteq N_G(H)$. If $N_G(H)=H$, then
$\gamma_{k-1}(G)\subseteq H$, a contradiction to the minimality of $k$. 
\end{proof}

For a group $G$, we define the sequence  $\zeta_0(G),\zeta_1(G),\dots$
recursively as follows: 
\[
	\zeta_0(G)=\{1\},\quad
	\zeta_{i+1}(G)=\{g\in G:[x,g]\in\zeta_{i}(G)\text{ for all $x\in G$}\},\quad i\geq 0.
\]
For example, $\zeta_1(G)=Z(G)$.

\begin{lemma}
\label{lem:central_ascendente}
Let $G$ be a group. For every $i\geq0$, the set $\zeta_i(G)$ 
is a normal subgroup of $G$. 
\end{lemma}

\begin{proof}
We proceed by induction on $i$. The case $i=0$ is trivial, as 
$\zeta_0(G)=\{1\}$. Assume the result holds for some $i$.
We claim that $\zeta_{i+1}(G)$ is normal subgroup of $G$. 
Let $g,h\in \zeta_{i+1}(G)$ and $x\in G$. By the inductive hypothesis, 
\begin{align*}
	&[x,g^{-1}]=(xg^{-1})[x^{-1},g](xg^{-1})^{-1}\in\zeta_i(G)(xg^{-1})^{-1}=\zeta_i(G),\\
	&[x,gh]=[x,h][hxh^{-1},g]\in \zeta_{i}(G).
\end{align*}
Since $1\in\zeta_{i+1}(G)$, we conclude that each $\zeta_i(G)$ is a subgroup of $G$. 
Moreover, since 
	\[
	[xgx^{-1},y]=x[g,x^{-1}yx]x^{-1}\in\zeta_{i}(G)
	\]
for all $y\in G$, we obtain that $xgx^{-1}\in\zeta_{i+1}(G)$. 
\end{proof}

\begin{definition}
\index{Ascending central series}
Let $G$ be a group. The \emph{ascending central series} of $G$ 
is the sequence 
\[
\{1\}=\zeta_0(G)\subseteq\zeta_1(G)\subseteq\zeta_2(G)\subseteq\cdots
\]
\end{definition}

\begin{definition}
\index{Group!perfect}
A group $G$ is said to be \emph{perfect} if $[G,G]=G$.
\end{definition}

\begin{theorem}[Gr\"un]
\label{thm:Grun}
\index{Gr\"un's theorem}
If $G$ is a perfect group, then $Z(G/Z(G))=\{1\}$. 
\end{theorem}

\begin{proof}
    By definition, $[G,\zeta_2(G)]\subseteq Z(G)$ and 
    $[\zeta_2(G),G]\subseteq Z(G)$. Then 
    \[
    [G,G,\zeta_2(G)]=[G,\zeta_2(G),G]=\{1\}.
    \]
    By using the three subgroups lemma with $X=Y=G$ and $Z=\zeta_2(G)$, 
    \[
    [\zeta_2(G),G]=[\zeta_2(G),[G,G]]=[\zeta_2(G),G,G]=\{1\}.
    \]
    Thus $\zeta_2(G)\subseteq Z(G)$. 
    
    We aim to prove that $Z(G/Z(G))$ is trivial. Let $\pi\colon G\to G/Z(G)$ be the canonical map and 
    $g\in G$ be such that $\pi(g)$ is central. Since 
    \[
    1=[\pi(x),\pi(g)]=\pi([x,g])
    \]
    for all $x\in G$, $[x,g]\in Z(G)=\zeta_1(G)$ for all $x\in G$. Hence 
    $g\in\zeta_2(G)\subseteq Z(G)$. 
\end{proof}

\subsection{Berkovich's theorem}

We start with an exercise on the \emph{normal core} of a subgroup. 

\begin{exercise}
\label{xca:core}
	Let $G$ be a group and $A$ be a subgroup of $G$. Prove that
	\[
    \Core_{G}(A)=\bigcap_{x\in G}xAx^{-1}
    \]
    is the largest normal subgroup of $G$ contained in $A$. 
\end{exercise}

% \begin{svgraybox}
% 	Hagamos actuar a $G$ por multiplicación en las coclases de $A$: $g\cdot
% 	xA=gxA$. Esta acción induce un morfismo $\rho\colon G\to \Sym_{G/A}$ con
% 	núcleo
% 	\[
% 		\ker\rho=\bigcap_{x\in G}xAx^{-1}=\Core_G(A).
% 	\]
% 	Es claro entonces que $\Core_G(A)$ es un subgrupo normal de $G$ contenido
% 	en $A$. Si $K$ es un subgrupo normal de $G$ tal que $K\subseteq A$,
% 	entonces $K=xKx^{-1}\subseteq xAx^{-1}$ para todo $x\in G$. Luego
% 	$K\subseteq\Core_G(A)$.
% \end{svgraybox}


\begin{theorem}[Berkovich]
\index{Berkovich's theorem}
\label{thm:Berkovich}
Let $G$ be a finite solvable group and $H$ be a proper subgroup of $G$ with
the smallest possible index. Then $H$ is normal in $G$. 
\end{theorem}

\begin{proof}
    Note that $H$ is a maximal subgroup. Let $C=\Core_G(H)$. There are two cases to consider. 

    Assume first that $C\ne\{1\}$. Let $\pi\colon G\to G/C$ be the canonical map. 
    By the inductive hypothesis, $\pi(H)$ is normal in $\pi(G)=G/C$, as by the correspondence theorem, 
    \[
    (\pi(G):\pi(H))=(G:H)
    \]
    is the smallest possible index in $G/C$. Thus $H$ is normal in $G$ again by the correspondence theorem. 

    Assume now that $C=\{1\}$. Let $N$ be a minimal normal subgroup of $G$. 
    Since $N$ is abelian, $N\cap H$ is normal in $N$. Moreover, since $N$ is normal in $G$, $N\cap H$ is normal in $H$. Thus $N\cap H$ is a normal subgroup of $NH$. 
    
    We claim that $N\not\subseteq H$. If $N\subseteq H$, 
    then, for every $x\in G$, 
    \[
        N=xNx^{-1}\subseteq xHx^{-1}.
    \]
    Therefore 
    \[
    N\subseteq \bigcap_{x\in G}xHx^{-1}=\Core_G(H)=\{1\},
    \]
    a contradiction. 
    
    Since $H$ is maximal, either $NH=G$ or $NH=H$. If $NH=H$, then
    $N\subseteq NH=H$, a contradiction. Hence $NH=G$. Thus $N\cap H$ is a normal subgroup of $NH=G$. The minimality of $N$ implies then that 
    $N\cap H=\{1\}$ and therefore  
    \[
    |N||H|=\frac{|N||H|}{|N\cap H|}=|G|.
    \]
    This implies that $|N|=(G:H)$. 

    Let $H$ act on $N$ by conjugation. 
    By the fundamental counting principle, 
    \[
    |H\cdot x|=(H:H_x)
    \]
    for all $x\in N$. Since $H\cdot 1=\{1\}$, every orbit 
    has at most $|N|-1$ elements, that is 
    \[
    (H:H_x)=|H\cdot x|\leq |N|-1.
    \]
    for all $x\in N$. 
    
    Since $N$ is a normal subgroup of $G$, the set 
    $NH_x$ is a subgroup of $G$. 
    Moreover, 
    \[
    N\cap H_x\subseteq N\cap H=\{1\}.
    \]
    Thus 
    \[
    (G:NH_x)=\frac{|G|}{|NH_x|}=\frac{|G|}{|N||H_x|}=\frac{|N||H|}{|N||H_x|}=(H:H_x)
    \leq |N|-1=(G:H)-1,
    \]
    a contradiction. 
\end{proof}

The solution of the following exercise is implicit in 
the proof of Berkovich's theorem. 

\begin{exercise}
\label{xca:corefree_maximal}
    Let $G$ be a finite solvable group and $H$ a subgroup of $G$. 
    Assume that $H$ is contained in maximal subgroup $M$ such that $\Core_G(M)=\{1\}$. 
    Prove that $G$ has a subgroup with index equal to $(M:H)$. 
\end{exercise}
